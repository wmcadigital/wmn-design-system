{% macro wmndsFeedbackLoop(params) %}

{# Imports of components #}
{% from "wmnds/components/form-elements/checkboxes/_checkboxes.njk" import wmndsCheckboxes %}
{% from "wmnds/components/form-elements/text-input/_text-input.njk" import wmndsTextInput %}
{% from "wmnds/components/form-elements/textarea/_textarea.njk" import wmndsTextarea %}
{% from "wmnds/components/form-elements/checkboxes/_checkboxes.njk" import wmndsCheckboxes %}
{% from "wmnds/components/button/_button.njk" import wmndsButton %}

{# Set params #}
{% set isOpen = " wmnds-is--open" if params.isOpen %}
{% set isUsefulSent = " wmnds-is--sent" if params.isUsefulSent %}
{% set id = params.id if params.id else "feedback-loop" %} {# this is to pass unique id to this macro, to stop clashing of duplicate IDs with the preview page and the ACTUAL feedback loop in the footer #}



<div class="wmnds-feedback-loop{{isOpen}}">
  <!-- Prepopulated fields: start -->
  <input type="hidden" name="contentName" value="Page title">
  <input type="hidden" name="contentLastEditor" value="Editor name">
  <input type="hidden" name="serviceName" value="West Midlands Network Design system">
  <input type="hidden" name="contentLastUpdated" value="2021-03-19T11:18:15.532Z">
  <!-- Prepopulated fields: end -->
  <div class="wmnds-container wmnds-feedback-loop__questions">
    <div class="wmnds-feedback-loop__useful{{isUSefulSent}}">
      <span>Is this page useful?</span>
      <button class="wmnds-btn wmnds-btn--link wmnds-m-l-sm">Yes</button>
      <button class="wmnds-btn wmnds-btn--link wmnds-m-l-sm">No</button>
      <span class="wmnds-feedback-loop__sent-msg wmnds-m-b-none">Thank you for letting us know</span>
    </div>
    <div class="wmnds-feedback-loop__wrong">
      <button class="wmnds-btn wmnds-btn--link">Is there anything wrong with this page?</button>
    </div>
    <div class="wmnds-feedback-loop__sent-msg">
      <span>Thank you for letting us know. If you require urgent help, please contact our <a class="wmnds-link" href="#">Customer Service</a> team.</span>
    </div>
  </div>

  <form class="wmnds-container wmnds-feedback-loop__form wmnds-grid">
    <input type="hidden" name="contentWrong" value="true">
    <div class="wmnds-grid wmnds-grid--align-center wmnds-grid--justify-between wmnds-m-b-md">
      <legend class="wmnds-col-auto wmnds-m-none">
        <h2 class="h3">Help us improve West Midlands Network</h2>
      </legend>
      <button class="wmnds-btn wmnds-btn--link wmnds-col-auto wmnds-m-l-md">Close</button>
    </div>
    <div class="wmnds-col-1 wmnds-col-md-1-2">
      {{
        wmndsTextarea({
          id: (id + '-textarea'),
          name: "contentWrongComment",
          placeholder: 'Text',
          required: true,
          label: {
            contentText: 'What is wrong with this page?'
          },
          formGroup: {
            classes: 'wmnds-m-b-md'
          }
        })
      }}
    </div>
    <br>
    <div class="wmnds-col-1 wmnds-col-md-1-3">
      {{
        wmndsTextInput({
          id: (id + '-input'),
          name: "emailAddress",
          placeholder: 'Text',
          label: {
            contentText: "Email address (optional)"
          },
          formGroup: {
            classes: 'wmnds-m-b-md'
          }
        })
      }}
    </div>
    <br>
    <div class="wmnds-col-1">
      {{
        wmndsCheckboxes({
          items: [
            {
              id: (id + '-checkbox-consent'),
              contentText: "I consent to being contacted about the issue I am reporting (optional)"
            }
          ],
          name: "checkboxes-consent",
          classes: 'wmnds-m-b-none',
          hint: {
            contentText: ' '
          }
        })
      }}
      {{
        wmndsCheckboxes({
          items: [
            {
              id: (id + '-checkbox-privacy'),
              contentHTML: 'I agree to <a href="/">WMCAâ€™s Privacy Policy</a>',
              required: true
            }
          ],
          name: "checkboxes-privacy",
          classes: 'wmnds-m-b-lg',
          hint: {
            contentText: ' '
          }
        })
      }}
    </div>
    {{
      wmndsButton({
        contentText: "Submit",
        classes: "wmnds-btn--primary",
        role: "submit"
      })
    }}
  </form>
</div>

{% endmacro %}