{% extends "www/_layouts/layout-left-pane.njk" %}
{% set pageTitle = "Cookies" %}
{% set section="Patterns" %}
{% from "www/_partials/component-example/component-example.njk" import compExample %}
{% from "wmnds/patterns/cookies/cookies-banner/_cookies-banner.njk" import wmndsCookiesBanner %}
{% from "wmnds/patterns/cookies/cookies-manager/_cookies-manager.njk" import wmndsCookiesManager %}


{% block content %}

<h2>About</h2>
{# What #}
<h3>What does it do?</h3>
<ul>
    <li>Allows users to accept or amend our website's cookie settings.</li>
    <li>Our cookie preferences should be confirmed before a user can use our website.</li>
    <li>The Manage cookies pattern allows users to change their cookie preferences.</li>
</ul>
<br><br>
<h2>Cookie banner</h2>
{# When to #}
<h3>When to use it?</h3>
<ul>
    <li>When a user first visits the West Midlands Network website and has not accepted or amended the cookie preferences.</li>
    <li>The banner should be above the header on every page and only disappear when a user has accepted or amended their cookie preferences.</li>
</ul>
{# When not to #}
<h3>When not to use it?</h3>
<ul>
  <li>When a user has accepted or amended the website's cookies.</li>
    <li>When a returning user visits the West Midlands Network website and has already accepted or amended their cookies in a previous session.</li>
</ul>
{# How #}
<h3>How it works</h3>
<ul>
    <li>When a user has accepted or amended the website's cookies.</li>
    <li>When a returning user visits the West Midlands Network website and has already accepted or amended their cookies in a previous session.</li>
</ul>
<p>The Cookies banner should be placed above the main header and be on every page</p>


{{
  compExample([
    wmndsCookiesBanner()
  ])
}}

<br><br>
<h2 id="cookies_manager">Manage Cookies</h2>
{# When to #}
<h3>When to use it?</h3>
<ul>
    <li>Users can manage their cookies through the 'Manage cookies' button in the Cookie banner.</li>
    <li>The Manage cookies pattern is also accessible from the main Policies page, so users can amend their cookie preferences at any time.</li>
</ul>

{{
  compExample([
    wmndsCookiesManager()
  ])
}}


<h3>We recommend using this additional code</h3>
<pre>
  <code class="html wmnds-show-more-ignore" tabindex="0">
  {%- filter forceescape %}
  <script>
    /*
    // Creation of default Cookies permissions //
    document.addEventListener("DOMContentLoaded", function(){
      // Handler when the DOM is fully loaded
      setCookiePolicy(true, false, false);
    });

    // JS for Accept all cookies //
    var acceptAllCookiesBtn = document.querySelector(".wmnds-accept-all-cookies-btn");
    acceptAllCookiesBtn.addEventListener("click", function(event){acceptAllCookies(event.target)});
    acceptAllCookiesBtn.addEventListener("keydown", function(event){
      if (event.key === " " || event.key == "Enter" || event.key === "Spacebar"){
        event.preventDefault();
        acceptAllCookies(event.target);
      }
    });

    function acceptAllCookies( event ){
      setCookiePolicy(true, true, true);
      var cookiesBanner = document.querySelector("#wmnds-cookies-banner");
      cookiesBanner.style= "opacity: 0.5";
      getCookiePolicy();
    }


    // cookies.js

    function setCookiePolicy( essential, functional, performance) {
      var cookieValue = {
        "essential": essential, 
        "functional": functional, 
        "performance": performance 
      };
      setCookie("cookies-policy", JSON.stringify(cookieValue), 181);
    }
    function getCookiePolicy( ) {

      getCookie("cookies-policy");
      console.log(getCookie("cookies-policy"));
      //setCookie("cookies-policy", JSON.stringify(cookieValue), 181);
      //return cookieValue;
    }

    function setCookie(cname, cvalue, exdays) {
      var d = new Date();
      d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
      var expires = "expires="+d.toUTCString();
      document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    function getCookie(cname) {
      var name = cname + "=";
      var ca = document.cookie.split(';');
      for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }

    function checkCookie(cname) {
      var isCookieCreated = getCookie(cname);
      if (!isCookieCreated ) {
        return false;
      } 
      return true;
    }*/

  </script>
  {%- endfilter %}
  </code>
</pre>

{% endblock %}
